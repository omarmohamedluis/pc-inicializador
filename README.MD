# PC Inicializador - Automatizaci√≥n de instalaci√≥n limpia en Windows

Una suite automatizada de scripts batch para inicializar un PC con Windows limpio, instalando software esencial y clonando repositorios privados de GitHub.

**Flexible y reutilizable:** A√±ade o quita paquetes y repositorios simplemente editando `install.json` y `repos.json`. No requiere modificar los scripts.

---

## üìã Requisitos Previos

Antes de ejecutar el maestro, verifica que tu PC cumpla con estos requisitos:

### **Sistema Operativo**
- Windows 10 (versi√≥n 1809 o superior) o Windows 11
- Acceso de **administrador** en la m√°quina

### **Dependencias Cr√≠ticas**

#### 1. **Git para Windows**
Necesario para clonar los repositorios privados.

**Verificar si est√° instalado:**
```powershell
git --version
```

**Si NO est√° instalado, desc√°rgalo:**
- Ir a: https://git-scm.com/download/win
- Ejecutar el instalador `.exe`
- Seguir los pasos con opciones por defecto
- Reinicia la terminal/PowerShell despu√©s de instalar

#### 2. **Winget** (Gestor de paquetes Windows)
Incluido en Windows 11 por defecto. En Windows 10, debe instalarse:

**Verificar si est√° instalado:**
```powershell
winget --version
```

**Si NO est√° instalado en Windows 10:**
1. Ir a: https://aka.ms/getwinget
2. Descargar e instalar la **App Installer** desde Microsoft Store
3. O desde PowerShell (como admin):
```powershell
Invoke-WebRequest -Uri https://aka.ms/wingetcli -OutFile winget.msixbundle
Add-AppxPackage -Path winget.msixbundle
```

#### 3. **PowerShell 5.1 o Superior**
Incluido en Windows 10/11. Verificar:
```powershell
$PSVersionTable.PSVersion
```

---

## üöÄ C√≥mo Ejecutar

### **Opci√≥n 1: L√≠nea de Comandos (Recomendado)**

1. Abre **PowerShell como Administrador**
   - Click derecho en el men√∫ Inicio
   - Selecciona "Windows PowerShell (Admin)"

2. Navega al directorio donde descargaste los scripts:
```powershell
cd "C:\ruta\al\directorio\pc inicializador"
```

3. Ejecuta el maestro:
```batch
.\00-maestro.bat
```

### **Opci√≥n 2: Explorador de Archivos**

1. Navega a la carpeta `pc inicializador`
2. Click derecho sobre `00-maestro.bat`
3. Selecciona "Ejecutar como administrador"

### **Men√∫ Interactivo con Validaci√≥n**

El maestro presenta un men√∫ inteligente que:
- ‚úÖ Verifica autom√°ticamente si Git y Winget est√°n instalados
- ‚úÖ Te gu√≠a si falta alguna dependencia
- ‚úÖ Permite elegir qu√© ejecutar:
  - **Opci√≥n 1:** Solo Windows Update + Winget
  - **Opci√≥n 2:** Solo instalar/actualizar software
  - **Opci√≥n 3:** Solo clonar/actualizar repositorios
  - **Opci√≥n 4:** Ejecutar todos los pasos
  - **Opci√≥n 5:** Ver log de instalaci√≥n
  - **Opci√≥n 0:** Salir

Esto permite **reutilizar el script** en cualquier momento. Por ejemplo, puedes ejecutarlo mensualmente para:
- Instalar nuevos paquetes
- Actualizar Windows
- Clonar/actualizar repositorios privados

---

## üì¶ ¬øQu√© instala?

El sistema ejecuta **3 pasos principais**:

### **Paso 1: Windows Update + Winget Setup**
- Instala/actualiza Windows Update
- Configura winget como gestor de paquetes
- Duraci√≥n: ~5-15 minutos

### **Paso 2: Instalaci√≥n de Software**
Instala todos los paquetes desde `install.json` (actualmente **26 paquetes**):
- **Audio/DAW:** Cockos REAPER
- **Desarrollo:** Node.js 22, .NET SDK 8, Git
- **Navegadores:** Google Chrome, Microsoft Edge
- **Herramientas:** Wireshark, FFmpeg, Advanced IP Scanner, Bonjour, NDI Tools
- **Utilidades:** Windows Terminal, VNC Viewer, Raspberry Pi Imager
- **Librer√≠as:** VCRedist (todas las versiones), UI.Xaml, VCLibs, CodeMeter

**Feedback visual:** 
- Muestra el progreso en tiempo real: `[5/26] Instalando Node.js...`
- Output completo de winget visible (sin silenciamiento)
- Indicador de √©xito/error para cada paquete

**Flexible:** A√±ade/quita paquetes directamente en `install.json` sin modificar scripts.

Duraci√≥n: ~10-30 minutos (depende del ancho de banda)

### **Paso 3: Clonar Repositorios GitHub**
Descarga/actualiza repositorios privados desde `repos.json` (actualmente **5 repositorios**):
- `acciones-reaper`
- `omi_reaper_lirycs`
- `agent`
- `companionconfigs`
- `disguise_omiweb_layer`

**Feedback visual:**
- Muestra progreso: `[2/5] Actualizando: omi_reaper_lirycs`
- Distingue entre clonar (nuevo) y actualizar (existente)
- Indicador de √©xito/error para cada repo

**Nota:** Se pedir√° un **GitHub Personal Access Token** (PAT)
- Los repos se descargar√°n a: `C:\Users\{Usuario}\Desktop\repositorios\`

**Flexible:** A√±ade/quita repositorios directamente en `repos.json` sin modificar scripts.

Duraci√≥n: ~1-5 minutos

## üìä Mejoras de Experiencia de Usuario

### **Validaci√≥n Autom√°tica de Dependencias**
- El maestro verifica Git y Winget al inicio
- Te gu√≠a autom√°ticamente si algo falta
- Evita errores confusos m√°s adelante

### **Feedback Visual Mejorado**
- Contadores de progreso: `[5/26] Instalando...`
- Separadores visuales claros (===)
- Indicadores de estado: `[OK]`, `[!]`, `[ERROR]`
- Output de winget mostrado en tiempo real (sin silenciamiento)

### **Mejor Manejo de Errores**
- Los scripts validan dependencias ANTES de ejecutar
- Muestra claramente qu√© falta y c√≥mo solucionarlo
- Distingue entre advertencias y errores cr√≠ticos

### **Res√∫menes Informativos**
- Al final de cada paso: resumen de √©xitos/fallos
- Ratio de paquetes instalados/repositorios clonados
- Links al log para revisar detalles

---

A diferencia de scripts desechables, **este sistema est√° dise√±ado para reutilizarse indefinidamente**:

### **Modificar Paquetes a Instalar**
Abre `install.json` y busca la secci√≥n `"Packages"`:
```json
{
    "PackageIdentifier": "NombrePaquete.ID"
}
```
- **A√±adir:** A√±ade una nueva entrada JSON
- **Quitar:** Elimina la entrada del paquete
- **Actualizar:** Modifica el nombre del paquete

Los scripts leer√°n autom√°ticamente la nueva lista.

### **Modificar Repositorios a Clonar**
Abre `repos.json` y busca la secci√≥n `"repositories"`:
```json
{
    "url": "https://github.com/usuario/repo.git",
    "name": "nombre-local",
    "private": true
}
```
- **A√±adir:** A√±ade un nuevo repositorio
- **Quitar:** Elimina la entrada del repo
- **Actualizar:** Modifica la URL o nombre

Los scripts leer√°n autom√°ticamente la nueva lista.

### **Casos de Uso Recurrentes**
Puedes ejecutar el maestro mensualmente o cuando necesites:
- ‚úÖ **Windows Updates:** Solo opci√≥n 1
- ‚úÖ **Nuevos paquetes:** Modifica `install.json` ‚Üí Opci√≥n 2
- ‚úÖ **Actualizar repos:** Solo opci√≥n 3
- ‚úÖ **Mantenimiento completo:** Opci√≥n 4 (todos los pasos)

---

### ¬øQu√© es un GitHub Personal Access Token (PAT)?
Es una contrase√±a segura que permite acceder a repositorios privados sin usar tu contrase√±a real.

### **C√≥mo generar un PAT:**

1. Ve a: https://github.com/settings/tokens
2. Click en "Generate new token" ‚Üí "Generate new token (classic)"
3. Dale un nombre: `PC Inicializador`
4. Marca estos permisos:
   - ‚úÖ `repo` (acceso a repositorios)
   - ‚úÖ `read:user` (leer informaci√≥n de usuario)
5. Click en "Generate token"
6. **Copia el token** (aparece solo una vez)

### **Usar el token:**
Cuando el script pida el token, p√©galo y presiona Enter.
- Requisito m√≠nimo: **20 caracteres**
- Se almacena de forma segura en: `C:\Users\{Usuario}\.git-credentials`

---

## üìä Archivos Generados

Despu√©s de ejecutar `00-maestro.bat`:

| Archivo | Descripci√≥n |
|---------|-------------|
| `install.log` | Registro completo de todas las operaciones |
| `C:\Users\{Usuario}\Desktop\repositorios\` | Directorio con los 4 repos clonados |
| `.git-credentials` | Credenciales seguras de Git (en perfil de usuario) |

---

## ‚ö†Ô∏è Notas Importantes

### **Limpieza Manual (Ya No Autom√°tica)**
Los scripts **NO se auto-eliminan** para permitir reutilizaci√≥n. Si deseas limpiar despu√©s:
```powershell
# Eliminar los scripts
Remove-Item "00-maestro.bat", "01-*.bat", "02-*.bat", "03-*.bat"

# Eliminar el estado
Remove-Item "estado.txt"

# O eliminar todo el directorio
Remove-Item . -Recurse
```

### **Reinicioss Autom√°ticos**
- Windows Update puede requerir uno o m√°s reinicios
- **NO es necesario esperar** el reinicio autom√°tico
- Puedes ejecutar de nuevo el maestro en cualquier momento

### **Conexi√≥n a Internet**
- Requerida durante toda la ejecuci√≥n
- Especialmente importante para descargar paquetes de software

### **Tiempo Total Esperado**
- Con conexi√≥n de 50+ Mbps: **30-60 minutos**
- Con conexi√≥n m√°s lenta: **1-2 horas**

### **En Caso de Errores**
Si un paso falla:
1. Revisa `install.log` (en Desktop) para detalles
2. Corrige el problema (ej: conexi√≥n a internet, permisos)
3. **Vuelve a ejecutar `00-maestro.bat`** - los scripts son idempotentes y pueden re-ejecutarse sin problemas

---

## üõ†Ô∏è Estructura del Proyecto

```
pc inicializador/
‚îú‚îÄ‚îÄ 00-maestro.bat                    (Script principal orquestador)
‚îú‚îÄ‚îÄ 01-windows-update-y-winget.bat    (Windows Update + Winget)
‚îú‚îÄ‚îÄ 02-instalar-software.bat          (Instalaci√≥n de 26 paquetes)
‚îú‚îÄ‚îÄ 03-descargar-repositorios.bat     (Clonar repos privados)
‚îú‚îÄ‚îÄ install.json                      (Lista de paquetes winget)
‚îú‚îÄ‚îÄ repos.json                        (Metadata de repositorios)
‚îú‚îÄ‚îÄ README.MD                         (Este archivo)
‚îî‚îÄ‚îÄ estado.txt                        (Generado en ejecuci√≥n - rastreo de progreso)
```

---

## ‚úÖ Validaci√≥n Post-Instalaci√≥n

Despu√©s de completar la ejecuci√≥n, verifica:

```powershell
# Verificar software instalado
winget list

# Verificar repositorios descargados
Get-ChildItem $env:USERPROFILE\Desktop\repositorios

# Verificar Token de Git almacenado
cat $env:USERPROFILE\.git-credentials
```

---

## üîí Seguridad

- Los scripts **NO** requieren conexi√≥n a servidores externos (excepto GitHub y winget)
- Todos los tokens se almacenan **localmente** en `.git-credentials`
- Los scripts son **autoautoLimpiable**: se eliminan a s√≠ mismos despu√©s de completar
- Se ejecutan con permisos de **administrador** necesarios solo para instalaciones del sistema

---

## üìù Logs y Debugging

Todos los eventos se registran en `install.log`:

```
[2026-02-04 10:15:30] === EJECUTANDO PASO 1 ===
[2026-02-04 10:15:35] Instalando PSWindowsUpdate...
[2026-02-04 10:20:15] Windows Update completado
[2026-02-04 10:20:20] === EJECUTANDO PASO 2 ===
...
```

Para revisar el log despu√©s:
```powershell
notepad install.log
```

---

## ü§ù Soporte

Si encuentras problemas:
1. **Lee `install.log`** para detalles del error
2. **Verifica requisitos previos** (Git, Winget, admin)
3. **Revisa la conexi√≥n a internet**
4. **Ejecuta nuevamente** - el script continuar√° desde el √∫ltimo paso completado

---

## üìÑ Licencia

Scripts de automatizaci√≥n para configuraci√≥n de PC limpio en Windows.

---

**√öltima actualizaci√≥n:** Febrero 2026  
**Versi√≥n:** 2.0 - Flexible y Reutilizable
